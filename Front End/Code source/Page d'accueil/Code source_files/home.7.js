!function($){$.bjHome=function(e,i){var o={search:{url:"/index/search",delay:100,minLength:3}},n=this,a=120;n.o={};var t=$(e),s=t.find("input.club-search-input"),r=t.find(".club-search-bar"),l=$("#search-default-view"),c=$("#club-search-bar-info"),d=t.find("div.club-search-icon"),h=$("#search-results"),u=t.find("div.club-search-reset"),f=t.find("a.club-search-geolocation"),p=t.find("div.club-search-geolocation-loading"),v=$("#discover-navbar"),m=$("#home-discover-navbar-button").parent(),g=$("#home-search-navbar-button").parent(),b=$(window),w=$("body"),y=$(document),j=$("html"),C=$("#main-alerts"),k=1,T=!1,x=0,I=0,E="",N=null,O="search";n.init=function(){n.o=$.extend(!0,{},o,i),P(),F(),bj.responsive.isPhone()||bj.$html.hasClass("msie")||setTimeout(function(){s.trigger("focus")},1),A(),$("#pricing-table").find("div[title], li[title]").tooltip({delay:400}),g.on("click","a",function(e){e.preventDefault(),D(),bj.$body.scrollTo(0,300,{offset:{top:-a}})}),m.on("click","a",function(e){e.preventDefault(),z(),bj.$body.scrollTo("#discover-reservation",300,{offset:{top:-a}})}),S("#discover-reservation"),$("#discover-keypoints").find('[data-role="waypoints"]').waypoint({offset:a+500,handler:function(e){var i=$(this.element).attr("id");S("#"+i)}}),$("#discover-kiosk, #discover-accesscontrol").waypoint({offset:a+400,handler:function(e){var i=$(this.element);i.find('[data-lazy-loaded="0"]').each(function(e,i){var o=$(i);o.attr("src",o.attr("data-src")),o.attr("data-lazy-loaded",1),o.parent().find(".swiper-lazy-preloader").remove()})}}),$("#discover-accesscontrol").waypoint({offset:a,handler:function(e){var i=$(this.element),o=i.attr("id");i.data("loaded")||($.get("/index/logo-wall",function(e){$("#discover-logo-wall").html(e)}),i.data("loaded",1))}})},n.search=function(e,i){R(),$.get(n.o.search.url,{search:e,city:i?i:0},function(e){"string"===$.type(e)&&"{"==new String(e).charAt(0)&&(e=$.parseJSON(e)),bj.notify.json(e),$.isPlainObject(e)&&!e.success||(h.html(e),setTimeout(function(e){F()},50)),H(),bj.$body.scrollspy("refresh")})};var P=function(){E=s.val(),E.length>0&&(c.hide(),f.hide(),u.show()),s.on("keyup",function(e){var i=bj.trim(s.val());0===i.length&&""!=E&&(clearTimeout(N),N=setTimeout(function(){n.search("",0),E=i},n.o.search.delay)),i.length<n.o.search.minLength&&i.length>0||E!=i&&(0===i.length?(u.hide(),s.val().length<1&&c.show(),f.show()):(c.hide(),f.hide(),u.show()),clearTimeout(N),N=setTimeout(function(){n.search(i),E=i},n.o.search.delay))});var e=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,i=function(i){return i.replace(e,"")};""!==i(s.val())&&t.addClass("home-input-search--filled"),s.on("focus",function(e){t.addClass("home-input-search--filled"),s.val().length<1&&c.show()}),s.on("blur",function(e){""===i($(this).val())&&(t.removeClass("home-input-search--filled"),c.hide())}),j.hasClass("geolocation")&&navigator.geolocation?(E.length<1&&f.show(),f.on("click",function(e){e.preventDefault(),f.hide(),p.show(),navigator.geolocation.getCurrentPosition(function(e){T=!0,x=e.coords.latitude,I=e.coords.longitude,$.get(n.o.search.url,{search:"geolocation",city:0,lat:x,lng:I},function(e){"string"===$.type(e)&&"{"==new String(e).charAt(0)&&(e=$.parseJSON(e)),bj.notify.json(e),$.isPlainObject(e)&&!e.success||(h.html(e),t.addClass("with-geolocation-result"),F()),p.hide(),f.show(),t.children(".popover").remove()})},function(e){switch(e.code){case e.PERMISSION_DENIED:alert("Vous devez autoriser le partage de votre localisation pour utiliser cette fonctionnalité (via Wi-Fi ou GPS). Sinon, vous pouvez aussi taper une ville dans le champ de recherche pour afficher les clubs à proximité.");break;case e.POSITION_UNAVAILABLE:alert("Position géographique indisponible. Tapez une ville dans le champ de recherche pour afficher les clubs à proximité.");break;case e.TIMEOUT:alert("La requête pour obtenir votre position geographique a pris trop de temps. Taper une ville dans le champ de recherche pour afficher les clubs à proximité.");break;case e.UNKNOWN_ERROR:alert("Une erreur inconnue est survenue. Nous ne sommes actuellement pas en mesure d'obtenir votre position géographique. Taper une ville dans le champ de recherche pour afficher les clubs à proximité.")}p.hide(),f.show(),t.children(".popover").remove()})})):f.parent().remove(),t.on("click","a.bjmap-page-skeleton",function(e){$(this).addClass("animated flash")}),t.on("click","div.club-search-icon",function(e){s.trigger("focus")}),t.on("click","a[data-city-id]",function(e){e.preventDefault(),n.search("",$(this).data("city-id"))}),bj.responsive.isTouch||t.find(".apply-popover").popover({html:!0,placement:"bottom"}),u.on("click",function(e){s.val("").trigger("keyup").trigger("focus"),u.hide(),f.show()})},S=function(e){if(e&&$(e).data("swiper-loaded"))return!1;var i=e?e+" .swiper-container-slide":".swiper-container-slide",o=new Swiper(i,{preloadImages:!0,lazy:!0,zoom:{maxRatio:bj.responsive.isPhone()?2.1:1.5},loop:!0,grabCursor:!0,speed:400,pagination:{el:".swiper-pagination",clickable:!0,renderBullet:function(e,i){return'<span class="'+i+'">'+(e+1)+"</span>"}},navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"}});e&&$(e).data("swiper-loaded",1)},A=function(){bj.responsive.isPhone()||($("#discover-start").waypoint({offset:a,handler:function(e){"down"===e?z():D()}}),v.find(".nav > li > a").on("click",function(e){e.preventDefault();var i=$(this);bj.$body.scrollTo(i.attr("href"),500,{offset:{top:-a}})}),setTimeout(function(){Waypoint.refreshAll()},2e3))},D=function(){"search"!==O&&(v.hide(),r.show().animateCss("slideInDown animated-400",function(e){s.val().length<1&&c.show()}),g.addClass("hidden"),m.removeClass("hidden").animateCss("slideInLeft animated-300"),O="search")},z=function(){"discover"!==O&&(c.hide(),r.hide(),v.show().animateCss("slideInDown animated-400",function(e){}),m.addClass("hidden"),g.removeClass("hidden").animateCss("slideInRight animated-300"),O="discover")},F=function(){!k&&window.scrollTo(0,0),h.find("a.--add-hover").removeClass("--add-hover").addClass("--hover"),Waypoint.refreshAll(),k=0},L=function(){},R=function(){bj.loading.show(),d.addClass("loading").children("i").removeClass("icon-search").addClass("icon-loading icon-spin")},H=function(){bj.loading.hide(),d.removeClass("loading").children("i").removeClass("icon-loading icon-spin").addClass("icon-search")};n.init()},$.fn.bjHome=function(e){return this.each(function(){if(void 0==$(this).data("bjHome")){var i=new $.bjHome(this,e);$(this).data("bjHome",i)}})}}(jQuery);